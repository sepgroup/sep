CREATE TABLE Project_tmp(ProjectID INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, ProjectName VARCHAR(50) NOT NULL, StartDate DATE, Deadline Date, Budget FLOAT CHECK(Budget > 0), Done BOOLEAN, FKManagerID INT, ProjectDescription TEXT, FOREIGN KEY (FKManagerID) REFERENCES User(UserID) ON DELETE CASCADE, CONSTRAINT chk_date CHECK(Deadline >= StartDate));
INSERT INTO Project_tmp(ProjectID, ProjectName, StartDate, Deadline, Done) SELECT PID, ProjectName, StartDate, DeadLine, Done FROM Project;
ALTER TABLE Project_tmp RENAME TO Project;

INSERT INTO Project(ProjectName, StartDate, Deadline, Budget, Done, FKManagerID, ProjectDescription) VALUES ("test", "2016-04-28", "2016-05-04", 2000, 1, 1, "test test");

CREATE TABLE User_tmp(UserID INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, FirstName VARCHAR(50), LastName VARCHAR(50), SalaryPerHour FLOAT);
INSERT INTO User_tmp(UserID, FirstName, LastName, SalaryPerHour, UserName, PassWord, IsManager) SELECT ResourceID, FirstName, LastName, SalaryPerHour, UserName, PassWord, IsManager FROM User;
ALTER TABLE User_tmp RENAME TO User;

CREATE TABLE Task_tmp(TaskID INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, FKProjectID INTEGER NOT NULL, TaskName VARCHAR(50) NOT NULL, StartDate DATE, Deadline Date, Budget FLOAT CHECK(Budget > 0), Done BOOLEAN, Tags TEXT, TaskDescription TEXT, FKUserID INT, FOREIGN KEY (FKProjectID) REFERENCES Project(ProjectID) ON DELETE CASCADE, FOREIGN KEY (FKUserID) REFERENCES User(UserID) ON DELETE CASCADE);
ALTER TABLE Task_tmp RENAME TO Task;

CREATE TABLE AssignedTask(FKUserID INT NOT NULL, FKTaskID INT NOT NULL, Tags TEXT, StartDate DATE, Deadline DATE, RequiredHoursWork INT, Done BOOLEAN, FOREIGN KEY (FKUserID) REFERENCES User(UserID) ON DELETE CASCADE, FOREIGN KEY (FKTaskID) REFERENCES Task(TaskID) ON DELETE CASCADE);
INSERT INTo Task (FKProjectID, TaskName, StartDate, Deadline, Budget, Done, Tags, TaskDescription, FKUserID) VALUES (1, "DataBase Design", "2016-04-28", "2016-05-05", 2000, 0, "Database, sqlite, Efficient", "sdfsdf", 1);
INSERT INTo AssignedTask (UserID, TaskID, Tags, StartDate, Deadline, RequiredHoursWork, Done) VALUES (1, 1, "Efficiency Progress", "2016-05-01", "2016-05-04", 30, 0);

CREATE TABLE TaskDependency_tmp(FKTaskID INT NOT NULL, DependOnTaskID INT NOT NULL,FOREIGN KEY (FKTaskID) REFERENCES Task(TaskID) ON DELETE CASCADE, FOREIGN KEY (DependOnTaskID) REFERENCES Task(TaskID) ON DELETE CASCADE);
ALTER TABLE TaskDependency_tmp RENAME TO TaskDependency;
INSERT INTO TaskDependency (FKTaskID, DependOnTaskID) VALUES (7,6);

ALTER TABLE Task ADD COLUMN FKUserID INT;

CREATE TABLE Task_tmp(TaskID INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, FKProjectID INTEGER NOT NULL, TaskName VARCHAR(50) NOT NULL, StartDate DATE, Deadline Date, Budget FLOAT CHECK(Budget > 0), Done BOOLEAN, Tags TEXT, TaskDescription TEXT, FKUserID INT, FOREIGN KEY (FKProjectID) REFERENCES Project(ProjectID) ON DELETE CASCADE, CONSTRAINT chk_date CHECK(Deadline >= StartDate));
INSERT INTo Task (FKProjectID, TaskName, StartDate, Deadline, Budget, Done, Tags, TaskDescription, FKUserID) VALUES (2, "DataBase Design", "2016-04-28", "2016-05-05", 2050, 1, "Database, sqlite, Efficient", "sdfsddvcvf", 2);
